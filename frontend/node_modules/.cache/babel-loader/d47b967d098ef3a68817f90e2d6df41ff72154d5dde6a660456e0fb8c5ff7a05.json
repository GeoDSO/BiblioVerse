{"ast":null,"code":"import React,{useState,useEffect,useRef}from\"react\";import{Document,Page,pdfjs}from\"react-pdf\";import\"./lectorlibro.css\";import{gsap}from\"gsap\";import\"react-pdf/dist/Page/AnnotationLayer.css\";import\"react-pdf/dist/Page/TextLayer.css\";// üí° Worker correcto\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";pdfjs.GlobalWorkerOptions.workerSrc=new URL(\"pdfjs-dist/build/pdf.worker.min.js\",import.meta.url).toString();function LectorLibro(_ref){let{url,onClose}=_ref;const[numPages,setNumPages]=useState(null);const[pageNumber,setPageNumber]=useState(1);const[pageWidth,setPageWidth]=useState(400);const[scale,setScale]=useState(1);const containerRef=useRef(null);const bookRef=useRef(null);// Ajuste de tama√±o din√°mico\nuseEffect(()=>{const handleResize=()=>{if(containerRef.current){const availableWidth=containerRef.current.offsetWidth;setPageWidth(Math.min(availableWidth/2-50,550));}};handleResize();window.addEventListener(\"resize\",handleResize);return()=>window.removeEventListener(\"resize\",handleResize);},[]);const onDocumentLoadSuccess=_ref2=>{let{numPages}=_ref2;setNumPages(numPages);setPageNumber(1);};const animarCambio=direccion=>{if(!bookRef.current)return;const tl=gsap.timeline();const xDir=direccion===\"next\"?-40:40;tl.to(bookRef.current,{opacity:0,x:xDir,duration:0.2,ease:\"power1.out\",scale:scale// Mantener el scale actual\n});tl.set(bookRef.current,{x:-xDir,scale:scale});tl.to(bookRef.current,{opacity:1,x:0,duration:0.25,ease:\"power2.out\",scale:scale// Mantener el scale actual\n});};const nextPage=()=>{if(pageNumber+2<=numPages){animarCambio(\"next\");setTimeout(()=>setPageNumber(pageNumber+2),200);}};const prevPage=()=>{if(pageNumber-2>=1){animarCambio(\"prev\");setTimeout(()=>setPageNumber(pageNumber-2),200);}};const zoomIn=()=>{setScale(prev=>Math.min(prev+0.2,2.5));};const zoomOut=()=>{setScale(prev=>Math.max(prev-0.2,0.6));};const resetZoom=()=>{setScale(1);};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",ref:containerRef,onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:onClose,children:\"\\u2716\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"zoom-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"zoom-btn\",onClick:zoomOut,disabled:scale<=0.6,title:\"Reducir zoom\",children:\"\\uD83D\\uDD0D-\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"zoom-indicator\",children:[Math.round(scale*100),\"%\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"zoom-btn\",onClick:zoomIn,disabled:scale>=2.5,title:\"Aumentar zoom\",children:\"\\uD83D\\uDD0D+\"}),/*#__PURE__*/_jsx(\"button\",{className:\"zoom-btn reset-btn\",onClick:resetZoom,title:\"Restablecer zoom\",children:\"\\u21BB\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pages-container\",children:/*#__PURE__*/_jsx(Document,{file:url,onLoadSuccess:onDocumentLoadSuccess,onLoadError:err=>alert(\"Error al cargar PDF: \"+err.message),children:numPages&&/*#__PURE__*/_jsxs(\"div\",{ref:bookRef,className:\"book-pages\",style:{transform:\"scale(\".concat(scale,\")\")},children:[/*#__PURE__*/_jsx(Page,{pageNumber:pageNumber,width:pageWidth,renderAnnotationLayer:false,renderTextLayer:false}),pageNumber+1<=numPages&&/*#__PURE__*/_jsx(Page,{pageNumber:pageNumber+1,width:pageWidth,renderAnnotationLayer:false,renderTextLayer:false})]})})}),numPages&&/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:prevPage,disabled:pageNumber<=1,children:\"\\u2B05 Anterior\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-counter\",children:[\"P\\xE1gina \",pageNumber,\"\\u2013\",Math.min(pageNumber+1,numPages),\" de\",\" \",numPages]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:nextPage,disabled:pageNumber+1>=numPages,children:\"Siguiente \\u27A1\"})]})]})});}export default LectorLibro;","map":{"version":3,"names":["React","useState","useEffect","useRef","Document","Page","pdfjs","gsap","jsx","_jsx","jsxs","_jsxs","GlobalWorkerOptions","workerSrc","URL","import","meta","url","toString","LectorLibro","_ref","onClose","numPages","setNumPages","pageNumber","setPageNumber","pageWidth","setPageWidth","scale","setScale","containerRef","bookRef","handleResize","current","availableWidth","offsetWidth","Math","min","window","addEventListener","removeEventListener","onDocumentLoadSuccess","_ref2","animarCambio","direccion","tl","timeline","xDir","to","opacity","x","duration","ease","set","nextPage","setTimeout","prevPage","zoomIn","prev","zoomOut","max","resetZoom","className","onClick","children","ref","e","stopPropagation","disabled","title","round","file","onLoadSuccess","onLoadError","err","alert","message","style","transform","concat","width","renderAnnotationLayer","renderTextLayer"],"sources":["C:/Users/Geo/Desktop/TFG/frontend/src/componentes/lectorlibro.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Document, Page, pdfjs } from \"react-pdf\";\r\nimport \"./lectorlibro.css\";\r\nimport { gsap } from \"gsap\";\r\nimport \"react-pdf/dist/Page/AnnotationLayer.css\";\r\nimport \"react-pdf/dist/Page/TextLayer.css\";\r\n\r\n// üí° Worker correcto\r\npdfjs.GlobalWorkerOptions.workerSrc = new URL(\r\n  \"pdfjs-dist/build/pdf.worker.min.js\",\r\n  import.meta.url\r\n).toString();\r\n\r\nfunction LectorLibro({ url, onClose }) {\r\n  const [numPages, setNumPages] = useState(null);\r\n  const [pageNumber, setPageNumber] = useState(1);\r\n  const [pageWidth, setPageWidth] = useState(400);\r\n  const [scale, setScale] = useState(1);\r\n  const containerRef = useRef(null);\r\n  const bookRef = useRef(null);\r\n\r\n  // Ajuste de tama√±o din√°mico\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      if (containerRef.current) {\r\n        const availableWidth = containerRef.current.offsetWidth;\r\n        setPageWidth(Math.min(availableWidth / 2 - 50, 550));\r\n      }\r\n    };\r\n    handleResize();\r\n    window.addEventListener(\"resize\", handleResize);\r\n    return () => window.removeEventListener(\"resize\", handleResize);\r\n  }, []);\r\n\r\n  const onDocumentLoadSuccess = ({ numPages }) => {\r\n    setNumPages(numPages);\r\n    setPageNumber(1);\r\n  };\r\n\r\n  const animarCambio = (direccion) => {\r\n    if (!bookRef.current) return;\r\n    const tl = gsap.timeline();\r\n    const xDir = direccion === \"next\" ? -40 : 40;\r\n    tl.to(bookRef.current, {\r\n      opacity: 0,\r\n      x: xDir,\r\n      duration: 0.2,\r\n      ease: \"power1.out\",\r\n      scale: scale, // Mantener el scale actual\r\n    });\r\n    tl.set(bookRef.current, { x: -xDir, scale: scale });\r\n    tl.to(bookRef.current, {\r\n      opacity: 1,\r\n      x: 0,\r\n      duration: 0.25,\r\n      ease: \"power2.out\",\r\n      scale: scale, // Mantener el scale actual\r\n    });\r\n  };\r\n\r\n  const nextPage = () => {\r\n    if (pageNumber + 2 <= numPages) {\r\n      animarCambio(\"next\");\r\n      setTimeout(() => setPageNumber(pageNumber + 2), 200);\r\n    }\r\n  };\r\n\r\n  const prevPage = () => {\r\n    if (pageNumber - 2 >= 1) {\r\n      animarCambio(\"prev\");\r\n      setTimeout(() => setPageNumber(pageNumber - 2), 200);\r\n    }\r\n  };\r\n\r\n  const zoomIn = () => {\r\n    setScale(prev => Math.min(prev + 0.2, 2.5));\r\n  };\r\n\r\n  const zoomOut = () => {\r\n    setScale(prev => Math.max(prev - 0.2, 0.6));\r\n  };\r\n\r\n  const resetZoom = () => {\r\n    setScale(1);\r\n  };\r\n\r\n  return (\r\n    <div className=\"modal-overlay\" onClick={onClose}>\r\n      <div\r\n        className=\"modal-content\"\r\n        ref={containerRef}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <button className=\"close-btn\" onClick={onClose}>\r\n          ‚úñ\r\n        </button>\r\n\r\n        {/* Controles de zoom */}\r\n        <div className=\"zoom-controls\">\r\n          <button \r\n            className=\"zoom-btn\" \r\n            onClick={zoomOut}\r\n            disabled={scale <= 0.6}\r\n            title=\"Reducir zoom\"\r\n          >\r\n            üîç-\r\n          </button>\r\n          \r\n          <span className=\"zoom-indicator\">\r\n            {Math.round(scale * 100)}%\r\n          </span>\r\n          \r\n          <button \r\n            className=\"zoom-btn\" \r\n            onClick={zoomIn}\r\n            disabled={scale >= 2.5}\r\n            title=\"Aumentar zoom\"\r\n          >\r\n            üîç+\r\n          </button>\r\n          \r\n          <button \r\n            className=\"zoom-btn reset-btn\" \r\n            onClick={resetZoom}\r\n            title=\"Restablecer zoom\"\r\n          >\r\n            ‚Üª\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"pages-container\">\r\n          <Document\r\n            file={url}\r\n            onLoadSuccess={onDocumentLoadSuccess}\r\n            onLoadError={(err) => alert(\"Error al cargar PDF: \" + err.message)}\r\n          >\r\n            {numPages && (\r\n              <div \r\n                ref={bookRef} \r\n                className=\"book-pages\"\r\n                style={{ transform: `scale(${scale})` }}\r\n              >\r\n                <Page\r\n                  pageNumber={pageNumber}\r\n                  width={pageWidth}\r\n                  renderAnnotationLayer={false}\r\n                  renderTextLayer={false}\r\n                />\r\n                {pageNumber + 1 <= numPages && (\r\n                  <Page\r\n                    pageNumber={pageNumber + 1}\r\n                    width={pageWidth}\r\n                    renderAnnotationLayer={false}\r\n                    renderTextLayer={false}\r\n                  />\r\n                )}\r\n              </div>\r\n            )}\r\n          </Document>\r\n        </div>\r\n\r\n        {numPages && (\r\n          <div className=\"controls\">\r\n            <button\r\n              className=\"btn\"\r\n              onClick={prevPage}\r\n              disabled={pageNumber <= 1}\r\n            >\r\n              ‚¨Ö Anterior\r\n            </button>\r\n\r\n            <span className=\"page-counter\">\r\n              P√°gina {pageNumber}‚Äì{Math.min(pageNumber + 1, numPages)} de{\" \"}\r\n              {numPages}\r\n            </span>\r\n\r\n            <button\r\n              className=\"btn\"\r\n              onClick={nextPage}\r\n              disabled={pageNumber + 1 >= numPages}\r\n            >\r\n              Siguiente ‚û°\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LectorLibro;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}